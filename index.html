<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8">
<title>PRINTEE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Solaiman Lipi Font -->
<style>
@font-face {
    font-family: 'SolaimanLipi';
    src: url('https://cdn.jsdelivr.net/gh/medialab/solaiman-lipi-font/SolaimanLipi.ttf') format('truetype');
}

body {
    font-family: 'SolaimanLipi', sans-serif;
    font-size: 18px;
    margin: 4px;
    padding: 4px;
    color: #111;
}

h2 { text-align: center; margin: 8px; font-size: 24px; font-weight: 400; }

.print-btn, #saveJsonBtn, #loadJsonBtn, #addQuestion, #headingControl,
#fontControl, #perPageControl { 
    display: inline-block; 
    margin: 4px; 
}

.print-btn, #saveJsonBtn, #loadJsonBtn {
    padding:6px 10px; background:#0078d7; color:#fff;
    border:none; border-radius:3px; cursor:pointer; font-size:16px;
}

.questions {
    column-count: 2;
    column-gap: 5px;
    margin: 4px;
}

.question {
    margin-bottom: 8px;
    page-break-inside: avoid;
    font-weight: bold;
    position: relative;
    border: 1px solid #ccc;
    padding: 6px;
}

/* Edit/Delete buttons */
.delete-btn, .edit-btn {
    display: none;
    position: absolute;
    top: 0;
    right: 0;
    background: #e74c3c;
    color: #fff;
    border: none;
    border-radius: 3px;
    padding: 2px 6px;
    cursor: pointer;
    font-size: 12px;
    margin-left: 4px;
}
.edit-btn { background:#f39c12; right: 50px; }

/* Show buttons when active */
.question.active .delete-btn,
.question.active .edit-btn {
    display: block;
}

.options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4px;
    margin-left: 6px;
    font-weight: normal;
}

.correct { color: darkblue; font-weight: bold; }

/* Add Question */
#addQuestion { margin:10px 0; padding:10px; border:1px solid #ccc; }
#addQuestion input, #addQuestion select { 
    width:100%; margin:3px 0; padding:4px; 
}
#addQuestion button { padding:6px 10px; margin-top:6px; cursor:pointer; }

/* Edit Form */
.edit-form {
    margin-top:10px;
    padding:10px;
    background:#f7f7f7;
    border:1px solid #bbb;
}
.edit-form input, .edit-form select {
    width:100%;
    margin:4px 0;
    padding:4px;
}
.edit-form button{
    margin-top:6px; padding:5px 10px; cursor:pointer;
}

/* Pagination */
#pagination { text-align:center; margin: 10px 0; }
#pagination button {
    padding: 6px 12px;
    margin: 4px;
    background: #444;
    color:#fff;
    border:none; border-radius:3px; cursor:pointer;
}

/* MOBILE */
@media (max-width: 600px) {
    .questions { column-count: 1 !important; }
}

/* PRINT MODE */
@media print {
    .print-btn, #addQuestion, .delete-btn, .edit-btn,
    #headingControl, #fontControl, #saveJsonBtn,
    #loadJsonBtn, #pagination, #perPageControl,
    .edit-form {
        display: none !important;
    }
}
</style>
</head>
<body>

<!-- HEADING CONTROL -->
<div id="headingControl">
    <label>‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶π‡ßá‡¶°‡¶ø‡¶Ç:</label>
    <input type="text" id="headingInput" value="‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶™‡¶§‡ßç‡¶∞">
    <button onclick="updateHeading()">‡¶π‡ßá‡¶°‡¶ø‡¶Ç ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>

<!-- FONT CONTROL -->
<div id="fontControl">
    <label>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú:</label>
    <input type="number" id="questionFontSize" value="18"> px
    <label>‡¶Ö‡¶™‡¶∂‡¶®‡ßá‡¶∞ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú:</label>
    <input type="number" id="optionFontSize" value="16"> px
    <label>‡¶´‡¶®‡ßç‡¶ü ‡¶´‡ßç‡¶Ø‡¶æ‡¶Æ‡¶ø‡¶≤‡¶ø:</label>
    <select id="fontFamilySelect">
        <option value="SolaimanLipi">Solaiman Lipi</option>
        <option value="Arial">Arial</option>
        <option value="Tahoma">Tahoma</option>
        <option value="Times New Roman">Times New Roman</option>
    </select>
    <button onclick="applyFontSettings()">Apply Font</button>
</div>

<!-- PER PAGE CONTROL -->
<div id="perPageControl">
    <label>‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶™‡ßá‡¶ú‡ßá ‡¶ï‡ßü‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</label>
    <input type="number" id="perPageInput" value="10" min="1" style="width:80px;">
    <button onclick="updatePerPage()">Set</button>
</div>

<button class="print-btn" onclick="window.print()">üñ®Ô∏è Print</button>
<button id="saveJsonBtn">üíæ JSON ‡¶∏‡ßá‡¶≠</button>
<input type="file" id="loadJsonBtn" accept=".json">

<u><h2 id="mainHeading">‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶™‡¶§‡ßç‡¶∞</h2></u>

<!-- Add Question -->
<div id="addQuestion">
    <h3>‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶è‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
    <label>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</label>
    <input type="text" id="manualText">
    <label>‡¶ï) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optA">
    <label>‡¶ñ) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optB">
    <label>‡¶ó) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optC">
    <label>‡¶ò) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optD">

    <label>‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞:</label>
    <select id="correctOpt">
        <option value="A">‡¶ï</option>
        <option value="B">‡¶ñ</option>
        <option value="C">‡¶ó</option>
        <option value="D">‡¶ò</option>
    </select>

    <button id="addBtn">‡¶è‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>

<div class="questions" id="questions"></div>

<div id="pagination">
    <button onclick="prevPage()">‚¨Ö ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡ßü‡¶æ‡¶∏</button>
    <span id="pageInfo"></span>
    <button onclick="nextPage()">‡¶®‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‚û°</button>
</div>

<script>

function toBengaliNum(num){
    const bn=['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];
    return num.toString().split('').map(d=>bn[d]||d).join('');
}

let currentPage = 1;
let perPage = 10;
let questions = [];

/* Load LocalStorage */
window.addEventListener('load', () => {
    const savedQuestions = localStorage.getItem('questions');
    const savedHeading = localStorage.getItem('heading');
    const savedPerPage = localStorage.getItem('perPage');

    if(savedQuestions) questions = JSON.parse(savedQuestions);
    if(savedHeading){
        document.getElementById('mainHeading').innerText = savedHeading;
        document.getElementById('headingInput').value = savedHeading;
    }
    if(savedPerPage){
        perPage = parseInt(savedPerPage);
        document.getElementById('perPageInput').value = perPage;
    }

    renderQuestions();
});

/* Render */
function renderQuestions(showAll = false){
    const container = document.getElementById('questions');
    container.innerHTML='';

    const qSize = document.getElementById('questionFontSize').value + "px";
    const oSize = document.getElementById('optionFontSize').value + "px";
    const fontFam = document.getElementById('fontFamilySelect').value;

    const start = (currentPage - 1) * perPage;
    const end = start + perPage;

    const display = showAll ? questions : questions.slice(start, end);

    display.forEach((q,realIdx)=>{
        const idx = showAll ? realIdx : start + realIdx;

        const div=document.createElement('div');
        div.className='question';
        div.style.fontSize=qSize;
        div.style.fontFamily=fontFam;

        div.addEventListener("click", () => {
            document.querySelectorAll(".question").forEach(el=>el.classList.remove("active"));
            div.classList.add("active");
        });

        const labels=['‡¶ï','‡¶ñ','‡¶ó','‡¶ò'];
        div.innerHTML = `
            ${toBengaliNum(idx+1)}. ${q.text}
            <div class="options" style="font-size:${oSize}; font-family:${fontFam};">
                ${q.option.map((opt,i)=>`
                    <div class="${q.correct===['A','B','C','D'][i]?'correct':''}">
                        ${labels[i]}) ${opt}
                    </div>
                `).join('')}
            </div>
            <button class="edit-btn" onclick="showEditForm(${idx}, this)">‡¶è‡¶°‡¶ø‡¶ü</button>
            <button class="delete-btn" onclick="deleteQuestion(${idx})">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
        `;

        container.appendChild(div);
    });

    document.getElementById('pageInfo').innerText =
        `‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ${toBengaliNum(currentPage)} / ${toBengaliNum(Math.ceil(questions.length/perPage))}`;

    localStorage.setItem('questions', JSON.stringify(questions));
}

/* Show edit form */
function showEditForm(idx, button){
    const q = questions[idx];
    const parent = button.closest('.question');

    if(parent.querySelector(".edit-form")) return; 

    const form = document.createElement("div");
    form.className = "edit-form";

    form.innerHTML = `
        <label>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</label>
        <input id="eText" value="${q.text}">
        <label>‡¶ï:</label><input id="eA" value="${q.option[0]}">
        <label>‡¶ñ:</label><input id="eB" value="${q.option[1]}">
        <label>‡¶ó:</label><input id="eC" value="${q.option[2]}">
        <label>‡¶ò:</label><input id="eD" value="${q.option[3]}">

        <label>‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞:</label>
        <select id="eCorrect">
            <option value="A" ${q.correct==="A"?"selected":""}>‡¶ï</option>
            <option value="B" ${q.correct==="B"?"selected":""}>‡¶ñ</option>
            <option value="C" ${q.correct==="C"?"selected":""}>‡¶ó</option>
            <option value="D" ${q.correct==="D"?"selected":""}>‡¶ò</option>
        </select>

        <button onclick="saveEdit(${idx}, this)">Save</button>
        <button onclick="this.parentNode.remove()">Cancel</button>
    `;

    parent.appendChild(form);
}

/* Save edit */
function saveEdit(idx, btn){
    const form = btn.parentNode;

    const text=form.querySelector("#eText").value.trim();
    const optA=form.querySelector("#eA").value.trim();
    const optB=form.querySelector("#eB").value.trim();
    const optC=form.querySelector("#eC").value.trim();
    const optD=form.querySelector("#eD").value.trim();
    const correct=form.querySelector("#eCorrect").value;

    questions[idx] = {text:text, option:[optA,optB,optC,optD], correct:correct};

    renderQuestions();
}

/* Delete */
function deleteQuestion(idx){
    if(confirm("‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")){
        questions.splice(idx,1);
        renderQuestions();
    }
}

/* Add Question */
document.getElementById('addBtn').addEventListener('click',()=>{
    const text=document.getElementById('manualText').value.trim();
    const optA=document.getElementById('optA').value.trim();
    const optB=document.getElementById('optB').value.trim();
    const optC=document.getElementById('optC').value.trim();
    const optD=document.getElementById('optD').value.trim();
    const correct=document.getElementById('correctOpt').value;

    if(!text||!optA||!optB||!optC||!optD){
        alert("‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®");
        return;
    }

    questions.push({text:text, option:[optA,optB,optC,optD], correct:correct});
    renderQuestions();

    document.getElementById('manualText').value='';
    document.getElementById('optA').value='';
    document.getElementById('optB').value='';
    document.getElementById('optC').value='';
    document.getElementById('optD').value='';
});

/* Heading */
function updateHeading(){
    const h=document.getElementById('headingInput').value.trim();
    if(h){
        document.getElementById('mainHeading').innerText=h;
        localStorage.setItem('heading',h);
    }
}

/* Others */
function applyFontSettings(){ renderQuestions(); }
function prevPage(){ if(currentPage>1){ currentPage--; renderQuestions(); } }
function nextPage(){ if(currentPage < Math.ceil(questions.length/perPage)){ currentPage++; renderQuestions(); } }
function updatePerPage(){
    perPage = Number(document.getElementById("perPageInput").value);
    if(perPage < 1) perPage = 1;
    localStorage.setItem("perPage", perPage);
    currentPage = 1;
    renderQuestions();
}

/* SAVE JSON */
document.getElementById('saveJsonBtn').addEventListener('click',()=>{
    const dataStr=JSON.stringify({
        heading:document.getElementById('mainHeading').innerText,
        questions:questions
    },null,2);

    const blob=new Blob([dataStr],{type:"application/json"});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;
    a.download="questions.json";
    a.click();
    URL.revokeObjectURL(url);
});

/* LOAD JSON */
document.getElementById('loadJsonBtn').addEventListener('change',e=>{
    const file=e.target.files[0];
    if(!file) return;
    const reader=new FileReader();

    reader.onload=event=>{
        try{
            const data=JSON.parse(event.target.result);
            if(data.heading) document.getElementById('mainHeading').innerText=data.heading;
            if(data.questions) questions=data.questions;
            currentPage=1;
            renderQuestions();
        }catch(err){
            alert("Invalid JSON!");
        }
    }
    reader.readAsText(file);
});

/* PRINT MODE ‚Üí always show all */
window.addEventListener("beforeprint", () => {
    renderQuestions(true);
});
</script>

</body>
</html>
