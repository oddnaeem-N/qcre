<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>MCQ Exam</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:'SolaimanLipi', sans-serif; margin:0; padding:0; background:#f8f9fb;}
.container{max-width:600px;margin:auto;padding:20px;}
.card{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 8px #0002;margin-bottom:20px;}
h2{margin:0 0 15px;font-weight:600;text-align:center;}
button{padding:10px 18px;background:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:16px;}
button:hover{background:#005fc7;}
.question{padding:12px;border:1px solid #ddd;margin-bottom:12px;border-radius:8px;background:#fff;}
.option{border:1px solid #ccc;padding:8px;margin:6px 0;border-radius:5px;cursor:pointer;}
.option.locked{pointer-events:none; opacity:.7;}
.option.correct{background:#d6ffe2;border-color:#4CAF50;}
.option.wrong{background:#ffe2e2;border-color:#ff4d4d;}
#examPage{display:none;}
label{margin-right:5px;}
input[type=number]{width:60px;margin-right:10px;}
</style>
</head>
<body>

<div class="container">

<div id="homePage" class="card">
    <h2>üìò MCQ Exam</h2>
    <input type="file" id="jsonFile" accept=".json"><br><br>
    <label>Start Question:</label><input type="number" id="startQ" value="1" min="1">
    <label>End Question:</label><input type="number" id="endQ" value="24" min="1"><br><br>
    <button onclick="startExam()">Start Exam</button>
</div>

<div id="examPage" class="card">
    <h2>üìù Exam</h2>
    <div id="questionBox"></div>
    <button style="margin-top:20px;" onclick="goHome()">Back</button>
</div>

</div>

<script>
let master=[], selected=[], userAns={};

document.getElementById("jsonFile").addEventListener("change", e=>{
    const f=e.target.files[0];
    if(!f) return;
    const r=new FileReader();
    r.onload=ev=>{
        const data=JSON.parse(ev.target.result);
        if(!data.questions){ alert("Invalid JSON!"); return;}
        master=data.questions;
        alert("JSON Loaded! Total Questions: "+master.length);
    }
    r.readAsText(f);
});

function startExam(){
    if(!master.length){ alert("Upload JSON first!"); return; }

    let start=Number(document.getElementById("startQ").value)-1;
    let end=Number(document.getElementById("endQ").value);
    if(start<0) start=0;
    if(end>master.length) end=master.length;
    if(start>=end){ alert("Start should be less than End!"); return; }

    selected = master.slice(start,end);

    document.getElementById("homePage").style.display="none";
    document.getElementById("examPage").style.display="block";

    renderExam();
}

function renderExam(){
    const box=document.getElementById("questionBox");
    box.innerHTML="";
    selected.forEach((q,i)=>{
        const div=document.createElement("div");
        div.className="question";
        div.innerHTML=`<div style="font-weight:600">${i+1}. ${q.text}</div>`;
        const labels=["‡¶ï","‡¶ñ","‡¶ó","‡¶ò"];
        q.option.forEach((opt,j)=>{
            const odiv=document.createElement("div");
            odiv.className="option";
            odiv.innerHTML=`${labels[j]}) ${opt}`;
            odiv.addEventListener("click", ()=>{
                if(odiv.classList.contains("locked")) return;
                userAns[i]=j;
                Array.from(div.getElementsByClassName("option")).forEach(el=>el.classList.add("locked"));
                if(j===["A","B","C","D"].indexOf(q.correct)) odiv.classList.add("correct");
                else odiv.classList.add("wrong");
            });
            div.appendChild(odiv);
        });
        box.appendChild(div);
    });
}

function goHome(){
    selected=[]; userAns={};
    document.getElementById("examPage").style.display="none";
    document.getElementById("homePage").style.display="block";
}
</script>

</body>
</html>
