<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8">
<title>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡ßá‡¶ü</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Tiro Bangla', serif;
    font-size: 18px;
    margin:4px;
    padding:4px;
    color:#111;
}
h2 { text-align:center; margin:8px; font-size:24px; }

.print-btn {
    display:inline-block;
    padding:6px 10px;
    background:#0078d7;
    color:#fff;
    border:none;
    border-radius:3px;
    cursor:pointer;
    font-size:16px;
    margin:4px 4px 8px 0;
}

@media print {
    .print-btn,
    #addQuestion,
    .delete-btn,
    #headingControl,
    #importJsonBtn,
    #exportJsonBtn,
    #jsonFileInput {
        display:none !important;
    }
}

.questions {
    column-count:2;
    column-gap:5px;
    margin:4px;
}
.question {
    margin-bottom:8px;
    page-break-inside: avoid;
    font-weight:bold;
    position:relative;
}
.options {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:4px;
    margin-left:6px;
    font-weight:normal;
}
.correct { color:green; }

.delete-btn {
    position:absolute;
    top:0;
    right:0;
    background:#e74c3c;
    color:#fff;
    border:none;
    border-radius:3px;
    padding:2px 6px;
    cursor:pointer;
    font-size:12px;
}

/* Add Question Form */
#addQuestion {
    margin:10px 0;
    padding:10px;
    border:1px solid #ccc;
}
#addQuestion input, #addQuestion select {
    width:100%;
    margin:3px 0;
    padding:4px;
}
#addQuestion label { font-weight:bold; }
#addQuestion button { padding:6px 10px; margin-top:6px; cursor:pointer; }

/* Heading control */
#headingControl {
    margin:10px 0;
    padding:10px;
    border:1px solid #ccc;
}
#headingControl input {
    width:100%;
    margin:3px 0;
    padding:4px;
}
#headingControl button {
    padding:6px 10px;
    margin-top:6px;
    cursor:pointer;
}

/* Hide Choose File input on screen */
#jsonFileInput {
    display:none;
}
</style>
</head>

<body>

<!-- Heading Input Control -->
<div id="headingControl">
    <label>‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶π‡ßá‡¶°‡¶ø‡¶Ç:</label>
    <input type="text" id="headingInput" placeholder="‡¶π‡ßá‡¶°‡¶ø‡¶Ç ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
    <button onclick="updateHeading()">‡¶π‡ßá‡¶°‡¶ø‡¶Ç ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>

<button class="print-btn" onclick="window.print()">üñ®Ô∏è Print</button>

<button class="print-btn" id="exportJsonBtn" onclick="exportJSON()">üì§ Export JSON</button>

<button class="print-btn" id="importJsonBtn"
        onclick="document.getElementById('jsonFileInput').click()">
    üì• Import JSON
</button>

<input type="file" id="jsonFileInput" accept=".json" onchange="importJSON()">

<h2 id="mainHeading"></h2>

<!-- Add Question Form -->
<div id="addQuestion">
    <h3>‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶è‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</h3>

    <label>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</label>
    <input type="text" id="manualText" placeholder="‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" required>

    <label>A) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optA" required>
    <label>B) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optB" required>
    <label>C) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optC" required>
    <label>D) ‡¶Ö‡¶™‡¶∂‡¶®:</label><input type="text" id="optD" required>

    <label>‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞:</label>
    <select id="correctOpt">
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
        <option value="D">D</option>
    </select>

    <button id="addBtn">‡¶è‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>

<div class="questions" id="questions"></div>

<script>
// ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü (‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶ñ‡¶æ‡¶≤‡¶ø)
let questions = [];

// ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞
function toBengaliNum(num){
    const bn=['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];
    return num.toString().split('').map(d=>bn[d]||d).join('');
}

// LocalStorage ‡¶≤‡ßã‡¶°
window.addEventListener('load', () => {
    const savedQuestions = localStorage.getItem('questions');
    const savedHeading = localStorage.getItem('heading');

    if(savedQuestions) questions = JSON.parse(savedQuestions);
    if(savedHeading) {
        document.getElementById('mainHeading').innerText = savedHeading;
        document.getElementById('headingInput').value = savedHeading;
    }

    renderQuestions();
});

// Render questions
function renderQuestions(){
    const container = document.getElementById('questions');
    container.innerHTML='';

    questions.forEach((q,idx)=>{
        const div = document.createElement('div');
        div.className='question';
        div.innerHTML=`
            ${toBengaliNum(idx+1)}. ${q.text}
            <div class="options">
                ${q.option.map((opt,i)=>{
                    const label=['A','B','C','D'][i];
                    return `<div class="${q.correct===label?'correct':''}">
                            ${label}) ${opt}</div>`;
                }).join('')}
            </div>
            <button class="delete-btn" onclick="deleteQuestion(${idx})">‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®</button>
        `;
        container.appendChild(div);
    });

    localStorage.setItem('questions', JSON.stringify(questions));
}

// Delete question
function deleteQuestion(idx){
    if(confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶∏‡¶§‡ßç‡¶Ø‡¶ø‡¶á ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')){
        questions.splice(idx,1);
        renderQuestions();
    }
}

// Add new question
document.getElementById('addBtn').addEventListener('click',()=>{
    const text = document.getElementById('manualText').value.trim();
    const optA = document.getElementById('optA').value.trim();
    const optB = document.getElementById('optB').value.trim();
    const optC = document.getElementById('optC').value.trim();
    const optD = document.getElementById('optD').value.trim();
    const correct = document.getElementById('correctOpt').value;

    if(!text||!optA||!optB||!optC||!optD){
        alert('‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®');
        return;
    }

    questions.push({text:text, option:[optA,optB,optC,optD], correct:correct});
    renderQuestions();

    document.getElementById('manualText').value='';
    document.getElementById('optA').value='';
    document.getElementById('optB').value='';
    document.getElementById('optC').value='';
    document.getElementById('optD').value='';
});

// Update heading
function updateHeading(){
    const h = document.getElementById('headingInput').value.trim();
    if(h){
        document.getElementById('mainHeading').innerText = h;
        localStorage.setItem('heading', h);
    }
}

// Export JSON
function exportJSON(){
    const data = {
        heading: document.getElementById('mainHeading').innerText,
        questions: questions
    };

    const blob = new Blob([JSON.stringify(data, null, 2)], {type:"application/json"});
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "questions_backup.json";
    a.click();

    URL.revokeObjectURL(url);
}

// Import JSON
function importJSON(){
    const file = document.getElementById('jsonFileInput').files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = e => {
        const data = JSON.parse(e.target.result);

        if(data.heading){
            document.getElementById('mainHeading').innerText = data.heading;
            document.getElementById('headingInput').value = data.heading;
            localStorage.setItem('heading', data.heading);
        }

        if(data.questions){
            questions = data.questions;
            localStorage.setItem('questions', JSON.stringify(questions));
        }

        renderQuestions();
    };
    reader.readAsText(file);
}
</script>

</body>
</html>
